imagenet_subset = {
    "n3887697": "paper, towel",
    "n3888257": "parachute, chute",
    "n3908618": "pencil box, pencil case",
    "n3888605": "parallel bars, bars",
    "n3891251": "park bench",
    "n3908714": "pencil sharpener",
    "n3916031": "perfume, essence",
    "n3920288": "Petri dish",
    "n3929660": "pick, plectrum, plectron",
    "n3929855": "pickelhaube",
    "n3930313": "picket fence, paling",
    "n3930630": "check, pickup, pickup truck",
    "n3935335": "piggy bank, penny bank",
    "n3937543": "pill bottle",
    "n3938244": "pillow",
    "n3944341": "pinwheel",
    "n3950228": "pitcher, ewer",
    "n3954731": "plane, carpenters plane, woodworking plane",
    "n3958227": "plastic bag",
    "n3961711": "plate rack",
    "n3967562": "plow, plough",
    "n3976657": "pole",
    "n3977966": "check, police van, police wagon, paddy wagon, patrol wagon, wagon, black Maria",
    "n3980874": "poncho",
    "n4008634": "projectile, missile",
    "n4009552": "projector",
    "n4019541": "puck, hockey puck",
    "n4023962": "punching bag, punch bag, punching ball, punchball",
    "n4033901": "quill, quill pen",
    "n4033995": "quilt, comforter, comfort, puff",
    "n4037443": "racer, race car, racing car",
    "n4049303": "rain barrel",
    "n4067472": "reel",
    "n4070727": "refrigerator, icebox",
    "n4074963": "remote control, remote",
    "n4081281": "restaurant, eating house, eating place, eatery",
    "n4099969": "rocking chair, rocker",
    "n4116512": "rubber eraser, rubber, pencil eraser",
    "n4118776": "rule, ruler",
    "n4127249": "safety pin",
    "n4136333": "sarong",
    "n4141076": "sax, saxophone",
    "n4141327": "scabbard",
    "n4141975": "scale, weighing machine",
    "n4162706": "seat belt, seatbelt",
    "n4179913": "sewing machine",
    "n4192698": "shield, buckler",
    "n4204347": "shopping cart",
    "n4208210": "shovel",
    "n4209239": "shower curtain",
    "n4228054": "ski",
    "n4229816": "ski mask",
    "n4235860": "sleeping bag",
    "n4238763": "slide rule, slipstick",
    "n4239074": "sliding door",
    "n4243546": "slot, one-armed bandit",
    "n4251144": "snorkel",
    "n4254120": "soap dispenser",
    "n4254777": "sock",
    "n4258138": "solar dish, solar collector, solar furnace",
    "n4259630": "sombrero",
    "n4264628": "space bar",
    "n4265275": "space heater",
    "n4266014": "space shuttle",
    "n4270147": "spatula",
    "n4273569": "speedboat",
    "n4286575": "spotlight, spot",
    "n4317175": "stethoscope",
    "n4325704": "stole",
    "n4326547": "stone wall",
    "n4328186": "stopwatch, stop watch",
    "n4330267": "stove",
    "n4335435": "check, streetcar, tram, tramcar, trolley, trolley car",
    "n4336792": "stretcher",
    "n4344873": "studio couch, day bed",
    "n4346328": "stupa, tope",
    "n4347754": "submarine, pigboat, sub, U-boat",
    "n4350905": "suit, suit of clothes",
    "n4355338": "sundial",
    "n4357314": "sunscreen, sunblock, sun blocker",
    "n4366367": "suspension bridge",
    "n4367480": "swab, swob, mop",
    "n4370456": "sweatshirt",
    "n4371430": "swimming trunks, bathing trunks",
    "n4371774": "swing",
    "n4372370": "switch, electric switch, electrical switch",
    "n4376876": "syringe",
    "n4380533": "table lamp",
    "n4389033": "tank, army tank, armored combat vehicle, armoured combat vehicle",
    "n4392985": "tape player",
    "n4398044": "teapot",
    "n4399382": "teddy, teddy bear",
    "n4404412": "television, television system",
    "n4417672": "thatch, thatched roof",
    "n4418357": "theater curtain, theatre curtain",
    "n4423845": "thimble",
    "n4428191": "thresher, thrasher, threshing machine",
    "n4429376": "throne",
    "n4435653": "tile roof",
    "n9472597": "volcan"
}

import os

source_path = "/share/wenzhuoliu/torch_ds/imagenet"
target_path = "/share/wenzhuoliu/torch_ds/imagenet-subset"
imagenet100_classes = list(imagenet_subset.keys())

for class_i in imagenet_subset:
    os.symlink(os.path.join(source_path, "train", class_i), os.path.join(target_path, "train", class_i))
    os.symlink(os.path.join(source_path, "val", class_i), os.path.join(target_path, "val", class_i))
